# S3 (Object Storage) 

S3 is Amazon's object-storage solution.  Object-storage is ideal for unstructured data (images, videos, logs, backups) that does not require frequent editing.  S3 objects are stored in buckets, and are accessed through APIs or SDKs (programmatic access).  Buckets reside in a chosen region, are scalable (no hard limit), and highly durable (11 nines of durability), making S3 an ideal service for compliance archiving, massive library storage, audit trails, ML training data, etc.  S3 objects are easily accessible but not easily modified, making this service ideal for persistent storage. The S3 service offers a cost effective (pay as you go) solution for various data storage needs.

| Objects | Buckets |
| - | - |
| Key | Object |
| Value | Folder* |
| MetaData |


The S3 service can be accessed through the AWS CLI.
## Available S3 Commands
### https://docs.aws.amazon.com/cli/latest/reference/s3/
### https://docs.aws.amazon.com/cli/latest/reference/s3api/

- aws s3
    - A high level way to interact with S3 buckets and objects
- aws s3api
    - A low level way to interact with S3 buckets and objects

## S3 Bucket Types
- General Purpose Buckets
    - flat hierarchy.
    - original S3 bucket type.
    - recommended for most use cases.
    - used with all storage classes (except S3 Express One Zone storage class).
    - default 100 general buckets per account (upgradeable to 1000).

- Directory buckets
    - folder hierarchy.
    - recommended when you need single-digit millisecond performance on PUT and GET.
    - only to be used with S3 Express One Zone storage class.
    - individual directories can scale horizontally.
    - default limit of 10 directory buckets per account.

## S3 Bucket Folders

The S3 console allows users to create "folders", however S3 does not have Folders in the sense of a traditional filesystem, all S3 objects will still live at the bucket scope (no hierarchy).  When you create a folder in S3 console, S3 creates a `zero-byte` S3 object with a name that ends in a forward slash `myfolder/`
- S3 folders are not their own independent identities, but just S3 objects.
- S3 folders don't include metadata or permissions.
- S3 foders don't contain anything, they can't be full or empty.
- S3 folders aren't "moved", S3 objects containing the same prefix are renamed.

## S3 Objects

S3 Objects are resources that represent data, it is NOT infrastructure.

1. Etags (entity tag)
    - A response header that represents a resource that has changed (without the need to download)
    - The value of an etag is generally represented by a hashing function eg. MD5 or SHA-1
    - Etags are part of the HTTP protocol.
    - Etags are used for revalifation for caching systems.
    - Etags only reflect changes to the contents of an object, not its metadata
    - Etegs represent a specific version of an object
    - Useful when you want to programmatically detect content changes to S3 objects!

2. Checksums
    - Used to check the sum (amount) of data to ensure the data integrity of a file.
    - If data is downloaded and if in-transit data is loss or mangled, the checksum will determine there is something wrong with the file
    - Amazon S3 uses checksums to verify data integrity of files on the upload or download.
    - AWS allows you to change the checksum algorithm.
        - CRC32 (Cyclic Redundancy Check)
        - CRC32C
        - SHA1 (Secure Hash Algorithms)
        - SHA256

3. Object Prefixes
    - Simulated file-system folders in a flat hierarchy
    - Object prefixes are strings the procees the Object filename, and is a part of the Object key name.
    - Allows for a way to organize and structure objects in a flat hierarchy.

4. Object Metadata
    - attach data alongside the content, to describe the contents of the data
    - useful for catagorizing and organizing data
    - provides contents about the data
    - System defined metadata
        - Content Type
        - Cache Control
        - Content Disposition
        - Content Encoding
        - Content Language
        - Expires
        - X-amz-ebsite-redirection-location
    - User defined metadata
        - Can be anything you want it to be
        - Must start with `x-amz-meta-`
        - Key, Value pair

5. Object tags
    - Benefits resource tagging but at the object level

6. Object Locking (WORM)
    - Makes data files immutable
    - Can only be turned on at the creation of a bucket
    - For companies that need to prevent objects being deleted
        - Data integrity
        - Regulatory compliance
    - SEC 17a-4, CTCC, FINRA regulation compliant
    - Object retention is handled two different ways
        - Retention periods (fixed perios of time during which an object remains locked)
        - Legal holds (remains locked until you remove the hold)
    - Can only be configured via the AWS API (CLI, SDK) and NOT the AWS Console
        - To avoid misconfiguration by non-technical users locking objects

7. Object Versioning
    - have multiple versions of a data file

8. Bucket URI
    - A way to reference the address of S3 bucket and S3 objects.
    - `s3://myexamplebucket/`photo.jpg

## Storage Classes

1. S3 Standard (default)
    - Pricing
        - Storage per GB
        - Per Request
        - No Retrieval fee
        - No minimum storage duration charge

2. S3 Reduced Redundancy Storage (legacy)
    - NOT supposed to use this storage class

3. S3 Intelligent Tiering
    - Uses ML to analyze object usage and determine storage class
    - Charges a low monthly cost for object monitorinf and automation

4. S3 Express One-Zone
    - Single-digit ms performance, special bucket type
    - 50% less than Standard cost.
    - Stored in one zone
    - 10x faster
    - Pricing

5. S3 Standard-IA (infrequent access)
    - Fast
    - Cheaper if you access less than once a month
    - Extra fee to retrieve
    - 50% less than Standard (reduced availability)
    - Pricing
        - Storage per GB
        - Per Request
        - Has a Retrieval fee
        - Has a minimum storage duration charge of 30 days

6. S3 One-Zone-IA (infrequent access)
    - Fast Objects only exist in one AZ.
    - Cheaper than Standard IA by 20% less
    - Reduced durability, data could get destroyed
    - Extra fee to retrieve

7. S3 Glacier Instant Retrieval -> Uses S3
    - For long term cold storage
    - Get data instantly
    - Pricing
        - Storage per GB
        - Per Request
        - Has a Retrieval fee
        - Has a minimum storage duration charge of 90 days

8. S3 Glacier Flexible Retrieval -> Uses Galcier Vault
    - Takes minutes to hours to get data
    - There are 3 retrieval tiers
        - Expediated 1-5 minutes : 250 MB archive size
        - Standard 3-5 hours : no archive size limit
        - Bulk Tier 5-12 hours : no archive size limit    

9. S3 Glacier Deep Archive -> Uses Galcier Vault
    - The lowest cost storage class
    - Data retrieval time is 12 hours
        - Standard 12-48 hours
        - Bulk 12-48 hours

## Security Overview

- Bucket Policies
    - Define permissions for an entire S3 bucket using JSON-based access policy language
- Access Control Lists (ACLs)
    - Provide a legacy method to manage access permissions on individual objects and buckets
- AWS PrivateLink for Amazon S3
    - Enables private network access to S3, bypassing the public internet for enhanced security
- Cross-Origin Resource Sharing (CORS)
    - Allows restricted resources on a web page from another domain to be requested
- Amazon S3 Block Public Access
    - Offers settings to easily block public access to all your S3 resources
- IAM Access Analyzer for S3
    - Analyzes resource policies to help identify and mitigate potential access risks
- Internetwork Traffic Privacy
    - Ensures data privacy by encrypting data moving between AWS services and the Internet
- Object Ownership
    - Manages data ownership between AWS accounts when objects are uploaded to S3 buckets
- Access Points
    - Simplified managing data access at scale for shared datasets in S3
- Access Grants
    - Providing access to S3 data via a directory dervices e.g. Active Directory
- Versioning
    - Preserves, retrieves, and restores every version of every object stored in an S3 bucket
- MFA Delete
    - Adds an additional layer of security by requireing MFA for the deletion of S3 objects
- Object Tags 
    - Provides a way to categorize storage by assigning key-value pairs to S3 objects